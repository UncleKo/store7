{% extends "base.html" %}
{% load humanize wagtailimages_tags wagtailroutablepage_tags %}
{% block head_title %}Category: {{ category_name }}{% endblock %}
{% block content %}



<div id="item-list" class="container clearfix">

  {% include "parts/category-menu.html" %}

  {% if category_name %}
  <small>カテゴリー: </small>
  <h2 class="archive-heading">{{ category_name }}</h2>
  {% elif tag_name %}
  <small>タグ: </small>
  <h2 class="archive-heading">{{ tag_name }}</h2>
  {% endif %}

  <div class="category-item-list">

    {% for item in items %}

    <div>

      <div>
        {% if item.list_image %}
        <a href="{{ item.url }}">
          {% image item.list_image max-150x150 as img %}
          <img src="{{ img.url }}" class="thumb">
        </a>
        {% endif %}
      </div>

      <div>
        <a href="{{ item.url}}">
          {{ item.title }}
        </a>
      </div>

      <div>
        {% if item.discount_price %}
        ¥{{ item.discount_price | intcomma }}
        {% else %}
        ¥{{ item.price | intcomma}}
        {% endif %}
      </div>

    </div>

    {% empty %}

    <div class="empty">このカテゴリーの商品は現在ありません。</div>

    {% endfor %}

  </div>


</div>

{# Only show pagination if there is more than one page to click through #}
{% if items.paginator.num_pages > 1 %}
<div class="container">
  <div class="row">
    <div class="col-lg-12">
      <div class="pagination">
        {% if items.has_previous %}
        <li class="page-item">
          <a href="?page={{ items.previous_page_number }}" class="page-link">
            <span>&laquo;</span>
          </a>
        </li>
        {% endif %}

        {% for page_num in items.paginator.page_range %}
        <li class="page-item {% if page_num == items.number %} active{% endif %}">
          <a href="?page={{ page_num }}" class="page-link">
            {{ page_num }}
          </a>
        </li>
        {% endfor %}

        {% if items.has_next %}
        <li class="page-item">
          <a href="?page={{ items.next_page_number }}" class="page-link">
            <span>&raquo;</span>
          </a>
        </li>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endif %}

<h2>Tags:</h2>
  <small>
    {% for tag in tags %}
    <a href="{% routablepageurl page 'tag_view' tag.slug %}">
    {{ tag.name }}
    </a>
    {% endfor %}
  </small>

{% endblock content %}